<?xml version="1.0" encoding="UTF-8"?>
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <theme href="templates/index.html" />

    <notheme css:if-not-content="#visual-portal-wrapper" />

    <!-- Common Plone rules -->
    <rules css:if-content="#portal-top">
        <!-- Attributes -->
        <copy attributes="*" css:theme="html" css:content="html" />
        <!-- Base tag -->
        <before css:theme="title" css:content="base" />
        <!-- Title -->
        <replace css:theme="title" css:content="title" />
        <!-- Pull in Plone Meta -->
        <after css:theme-children="head" css:content="head meta" />
        <!-- Don't use Plone icons, use the theme's -->
        <drop css:content="head link[rel='apple-touch-icon']" />
        <drop css:content="head link[rel='shortcut icon']" />
        <!-- CSS -->
        <before css:theme-children="head" css:content="head link" />
        <before css:theme-children="head" css:content="head style" />
<!--         Script -->
        <before css:theme-children="head" css:content="head script" />
    </rules>

    <!-- Copy over the id/class attributes on the body tag. This is important for per-section styling -->
    <copy attributes="*" css:content="body" css:theme="body" />

    <!-- Navbar -->
    <replace css:content-children="#portal-globalnav" css:theme-children=".portaltabs" />

    <!-- Logo link -->
    <before css:theme-children=".portaltabs">
        <li id="logo" class="logo">
            <a href="./">
                <xsl:apply-templates css:select="#portal-logo img">
                </xsl:apply-templates>
            </a>
        </li>
    </before>
    <before css:theme-children=".portaltabs">
        <li id="navigation" class="button">
        </li>
    </before>

    <!-- Content body -->
    <replace css:content="#content" css:theme=".content_body" />

    <!-- Content body -->
    <replace css:content="#portal-languageselector" css:theme-children="#portal-languages" />
    <drop css:theme="#portal-languageselector" />

    <!-- toolbar -->
    <replace css:theme="#portal-toolbar" css:content-children="#edit-bar" css:if-not-content=".ajax_load" css:if-content=".userrole-authenticated" />
    <drop css:theme="#portal-toolbar" css:if-content=".userrole-anonymous" />
    <replace css:theme="#anonymous-actions" css:content-children="#portal-personaltools-wrapper" css:if-not-content=".ajax_load" css:if-content=".userrole-anonymous" />

    <replace
        css:theme="#footer"
        css:content="footer"
        href="/@@theme-fragment/footer"
        />

</rules>
